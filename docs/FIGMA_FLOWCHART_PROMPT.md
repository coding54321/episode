# Episode 서비스 프로세스 플로우차트 프롬프트

## 서비스 개요
Episode는 마인드맵 기반 취업준비 서비스로, 사용자의 경험을 구조화하고 STAR 방식으로 자기소개서를 작성할 수 있도록 도와주는 서비스입니다.

## 진입점 (Entry Points)
1. **랜딩 페이지** (`/`) - 로그인하지 않은 사용자 또는 로그인한 사용자 모두 접근 가능
2. **공유 링크** (`/share/[nodeId]`) - 로그인하지 않은 사용자도 접근 가능 (읽기 전용)
3. **OAuth 콜백** (`/auth/callback`) - 카카오 로그인 후 리다이렉트

---

## 전체 플로우차트 구조

### 1. 랜딩 페이지 진입 플로우

```
[랜딩 페이지 (/)]
    │
    ├─→ [로그인 상태 확인]
    │       │
    │       ├─→ [로그인 안됨] → [서비스 소개 표시] → [기능 소개 페이지 이동 가능]
    │       │                       │
    │       │                       ├─→ [마인드맵 기능 소개] → [시작하기] → [로그인 페이지]
    │       │                       ├─→ [공백 진단 기능 소개] → [시작하기] → [로그인 페이지]
    │       │                       └─→ [아카이브 기능 소개] → [시작하기] → [로그인 페이지]
    │       │
    │       └─→ [로그인 됨] → [프로젝트 목록 페이지로 리다이렉트]
    │
    └─→ [OAuth 콜백 처리]
            │
            └─→ [code 파라미터 있음] → [OAuth 콜백 페이지로 리다이렉트]
```

### 2. 인증 플로우

```
[로그인 페이지 (/login)]
    │
    ├─→ [로그인 상태 확인]
    │       │
    │       ├─→ [이미 로그인됨]
    │       │       │
    │       │       ├─→ [returnUrl 있음] → [returnUrl로 이동]
    │       │       └─→ [returnUrl 없음]
    │       │               │
    │       │               ├─→ [프로젝트 있음] → [프로젝트 목록 (/mindmaps)]
    │       │               └─→ [프로젝트 없음] → [배지 선택 페이지 (/badge-selection)]
    │       │
    │       └─→ [로그인 안됨] → [카카오 로그인 버튼 표시]
    │               │
    │               └─→ [카카오 로그인 클릭]
    │                       │
    │                       └─→ [카카오 OAuth 페이지로 리다이렉트]
    │                               │
    │                               └─→ [카카오 로그인 완료]
    │                                       │
    │                                       └─→ [OAuth 콜백 (/auth/callback?code=...)]
    │                                               │
    │                                               ├─→ [인증 코드 처리]
    │                                               │       │
    │                                               │       ├─→ [Supabase Auth로 사용자 정보 조회/생성]
    │                                               │       │       │
    │                                               │       │       ├─→ [성공] → [localStorage에 사용자 정보 저장]
    │                                               │       │       │       │
    │                                               │       │       │       └─→ [returnUrl 있음] → [returnUrl로 이동]
    │                                               │       │       │       └─→ [returnUrl 없음]
    │                                               │       │       │               │
    │                                               │       │       │               ├─→ [프로젝트 있음] → [프로젝트 목록]
    │                                               │       │       │               └─→ [프로젝트 없음] → [배지 선택 페이지]
    │                                               │       │       │
    │                                               │       │       └─→ [실패] → [에러 메시지 표시] → [로그인 페이지 유지]
    │                                               │       │
    │                                               │       └─→ [에러 발생] → [에러 메시지 표시] → [로그인 페이지로 리다이렉트]
```

### 3. 프로젝트 생성 플로우

```
[프로젝트 목록 페이지 (/mindmaps)]
    │
    ├─→ [로그인 확인]
    │       │
    │       ├─→ [로그인 안됨] → [로그인 페이지로 리다이렉트]
    │       │
    │       └─→ [로그인 됨] → [프로젝트 목록 조회]
    │               │
    │               ├─→ [프로젝트 있음] → [프로젝트 카드 표시]
    │               │       │
    │               │       ├─→ [프로젝트 클릭] → [마인드맵 편집 페이지 (/mindmap/[projectId])]
    │               │       ├─→ [즐겨찾기 토글] → [즐겨찾기 상태 업데이트]
    │               │       └─→ [새 프로젝트 버튼 클릭] → [배지 선택 페이지]
    │               │
    │               └─→ [프로젝트 없음] → [빈 상태 표시] → [새 프로젝트 버튼 표시]
    │                       │
    │                       └─→ [새 프로젝트 버튼 클릭] → [배지 선택 페이지]
    │
    └─→ [배지 선택 페이지 (/badge-selection)]
            │
            ├─→ [로그인 확인]
            │       │
            │       └─→ [로그인 안됨] → [로그인 페이지로 리다이렉트]
            │
            └─→ [로그인 됨] → [8가지 배지 표시]
                    │
                    ├─→ [배지 선택 (최소 1개 이상)]
                    │       │
                    │       ├─→ [기타 배지 선택] → [커스텀 라벨 입력 필드 표시]
                    │       │
                    │       └─→ [완료 버튼 클릭]
                    │               │
                    │               └─→ [프로젝트 초기화]
                    │                       │
                    │                       ├─→ [UUID 프로젝트 ID 생성]
                    │                       ├─→ [프로젝트명 자동 생성: '{사용자명}의 경험 맵']
                    │                       ├─→ [중앙 노드 생성]
                    │                       ├─→ [선택한 배지 수만큼 대분류 노드 생성 (원형 배치)]
                    │                       ├─→ [각 배지 노드를 중앙 노드의 자식으로 연결]
                    │                       ├─→ [Supabase DB에 프로젝트 정보 저장]
                    │                       │
                    │                       └─→ [마인드맵 편집 페이지로 이동]
```

### 4. 마인드맵 편집 플로우

```
[마인드맵 편집 페이지 (/mindmap/[projectId])]
    │
    ├─→ [로그인 확인]
    │       │
    │       ├─→ [로그인 안됨] → [로그인 페이지로 리다이렉트]
    │       │
    │       └─→ [로그인 됨] → [프로젝트 데이터 로드]
    │               │
    │               ├─→ [프로젝트 없음] → [에러 메시지] → [프로젝트 목록으로 리다이렉트]
    │               │
    │               └─→ [프로젝트 있음] → [노드 데이터 로드]
    │                       │
    │                       ├─→ [최초 진입] → [온보딩 튜토리얼 표시 여부 확인]
    │                       │       │
    │                       │       ├─→ [튜토리얼 미표시] → [4단계 튜토리얼 오버레이 표시]
    │                       │       │       │
    │                       │       │       ├─→ [건너뛰기] → [튜토리얼 표시 여부 저장] → [마인드맵 표시]
    │                       │       │       └─→ [완료] → [튜토리얼 표시 여부 저장] → [마인드맵 표시]
    │                       │       │
    │                       │       └─→ [튜토리얼 이미 표시됨] → [마인드맵 표시]
    │                       │
    │                       └─→ [마인드맵 캔버스 표시]
    │                               │
    │                               ├─→ [노드 조작]
    │                               │       │
    │                               │       ├─→ [노드 클릭] → [노드 선택] → [사이드바에 AI 어시스턴트 자동 표시]
    │                               │       │
    │                               │       ├─→ [노드 더블클릭] → [인라인 편집 모드] → [라벨 수정] → [Enter/포커스 아웃] → [저장]
    │                               │       │
    │                               │       ├─→ [노드 우클릭] → [컨텍스트 메뉴 표시]
    │                               │       │       │
    │                               │       │       ├─→ [하위 노드 추가] → [방향 선택] → [새 노드 생성] → [편집 모드]
    │                               │       │       ├─→ [편집] → [인라인 편집 모드]
    │                               │       │       ├─→ [STAR 정리하기] → [사이드바 STAR 탭 열기]
    │                               │       │       ├─→ [공유하기] → [공유 링크 생성 플로우]
    │                               │       │       ├─→ [공유 해제] → [공유 정보 삭제]
    │                               │       │       ├─→ [새 탭에서 열기] → [새 탭 생성]
    │                               │       │       └─→ [삭제] → [삭제 확인 다이얼로그] → [확인] → [노드 및 하위 노드 삭제]
    │                               │       │
    │                               │       ├─→ [노드 드래그] → [위치 이동] → [좌표 저장]
    │                               │       │
    │                               │       └─→ [노드에 마우스 오버] → ['+' 버튼 표시] → [클릭] → [하위 노드 추가]
    │                               │
    │                               ├─→ [캔버스 조작]
    │                               │       │
    │                               │       ├─→ [Ctrl/Cmd + 드래그] → [캔버스 이동]
    │                               │       │
    │                               │       └─→ [Alt + 마우스 휠] → [줌 인/아웃]
    │                               │
    │                               └─→ [사이드바 기능]
    │                                       │
    │                                       ├─→ [공백 진단하기 버튼 클릭] → [사이드바 열기] → [공백 진단 탭]
    │                                       │       │
    │                                       │       ├─→ [부족 역량확인 탭]
    │                                       │       │       │
    │                                       │       │       ├─→ [기업 선택] → [직무 목록 표시]
    │                                       │       │       │       │
    │                                       │       │       │       └─→ [직무 선택] → [문항 목록 표시]
    │                                       │       │       │               │
    │                                       │       │       │               └─→ [문항별 답변 어려움 선택 (쉬움/보통/어려움)]
    │                                       │       │       │                       │
    │                                       │       │       │                       ├─→ [어려움 선택] → [역량 태그 추출] → [추천 인벤토리에 자동 추가]
    │                                       │       │       │                       │
    │                                       │       │       │                       └─→ [모든 문항 완료] → [분석 결과 표시]
    │                                       │       │       │
    │                                       │       │       └─→ [추천 인벤토리 탭]
    │                                       │       │               │
    │                                       │       │               ├─→ [역량 태그 목록 조회]
    │                                       │       │               │
    │                                       │       │               ├─→ [역량 태그를 마인드맵 노드로 드래그]
    │                                       │       │               │       │
    │                                       │       │               │       └─→ [노드 추가 다이얼로그 표시]
    │                                       │       │               │               │
    │                                       │       │               │               ├─→ [노드 이름 입력] → [생성하기] → [새 노드 생성] → [AI 어시스턴트 자동 열기]
    │                                       │       │               │               │
    │                                       │       │               │               └─→ [취소] → [다이얼로그 닫기]
    │                                       │       │               │
    │                                       │       │               ├─→ [역량 태그 삭제]
    │                                       │       │               │
    │                                       │       │               └─→ [역량 태그 클릭] → [연결된 문항 목록 조회]
    │                                       │       │
    │                                       │       └─→ [어시스턴트 버튼 클릭] → [사이드바 열기] → [어시스턴트 탭]
    │                                       │               │
    │                                       │               └─→ [AI 챗봇 대화]
    │                                       │                       │
    │                                       │                       ├─→ [노드 선택 시 자동 표시]
    │                                       │                       │
    │                                       │                       ├─→ [STAR 단계별 대화 진행]
    │                                       │                       │       │
    │                                       │                       │       ├─→ [Situation 단계] → [질문 및 답변 수집]
    │                                       │                       │       ├─→ [Task 단계] → [질문 및 답변 수집]
    │                                       │                       │       ├─→ [Action 단계] → [질문 및 답변 수집]
    │                                       │                       │       └─→ [Result 단계] → [질문 및 답변 수집]
    │                                       │                       │
    │                                       │                       ├─→ [모든 단계 완료] → [STAR 초안 생성 버튼 활성화]
    │                                       │                       │       │
    │                                       │                       │       └─→ [STAR 초안 생성] → [STAR 에디터에 자동 로드]
    │                                       │                       │
    │                                       │                       └─→ [사용자 메시지 입력] → [AI 응답 생성] → [채팅 형식으로 표시]
    │                                       │
    │                                       └─→ [STAR 정리하기 버튼 클릭] → [사이드바 열기] → [STAR 탭]
    │                                               │
    │                                               ├─→ [에피소드 노드 목록 조회] → [카드 형식으로 표시]
    │                                               │       │
    │                                               │       └─→ [에피소드 카드 클릭] → [STAR 에디터 표시]
    │                                               │               │
    │                                               │               ├─→ [Situation, Task, Action, Result 편집]
    │                                               │               ├─→ [글자 수 실시간 표시 및 검증]
    │                                               │               ├─→ [자동 저장]
    │                                               │               └─→ [복사 버튼] → [클립보드 복사]
    │                                               │
    │                                               └─→ [사이드바 너비 조절] → [왼쪽 가장자리 드래그] → [너비 변경]
```

### 5. 공유 링크 플로우

```
[공유 링크 접근 (/share/[nodeId])]
    │
    ├─→ [nodeId 유효성 검증]
    │       │
    │       ├─→ [유효하지 않음] → [에러 메시지] → [404 페이지]
    │       │
    │       └─→ [유효함] → [공유 노드 정보 조회]
    │               │
    │               ├─→ [공유 노드 없음] → [에러 메시지] → [404 페이지]
    │               │
    │               └─→ [공유 노드 있음] → [노드 및 하위 노드 로드]
    │                       │
    │                       ├─→ [STAR 에셋 포함 여부 확인]
    │                       │
    │                       ├─→ [로그인 상태 확인]
    │                       │       │
    │                       │       ├─→ [로그인 안됨] → [읽기 전용 모드]
    │                       │       │       │
    │                       │       │       ├─→ [마인드맵 표시 (읽기 전용)]
    │                       │       │       ├─→ [공유한 사용자 정보 표시]
    │                       │       │       ├─→ [STAR 에셋 표시 (있는 경우)]
    │                       │       │       └─→ [읽기 전용 안내 오버레이 표시]
    │                       │       │
    │                       │       └─→ [로그인 됨] → [편집 모드 가능]
    │                       │               │
    │                       │               ├─→ [노드 추가/수정/삭제 가능]
    │                       │               ├─→ [노드 위치 이동 가능]
    │                       │               ├─→ [STAR 작성 가능]
    │                       │               └─→ [변경 사항을 원본 프로젝트에 반영]
    │                       │
    │                       └─→ [마인드맵 표시]
    │                               │
    │                               └─→ [노드 조작 (로그인한 경우)]
    │                                       │
    │                                       ├─→ [노드 추가] → [개별 노드 INSERT]
    │                                       ├─→ [노드 수정] → [개별 노드 UPDATE]
    │                                       ├─→ [노드 삭제] → [개별 노드 DELETE]
    │                                       └─→ [노드 이동] → [좌표만 UPDATE]
```

### 6. 공유 링크 생성 플로우

```
[마인드맵 편집 페이지]
    │
    └─→ [노드 우클릭] → [공유하기 선택]
            │
            └─→ [공유 노드 정보 수집]
                    │
                    ├─→ [공유할 노드 및 하위 노드 정보]
                    ├─→ [STAR 에셋 포함 여부 선택]
                    │
                    └─→ [Supabase shared_nodes 테이블에 저장]
                            │
                            ├─→ [공유 링크 생성: /share/{nodeId}]
                            ├─→ [클립보드에 자동 복사]
                            ├─→ [복사 완료 토스트 메시지 표시]
                            └─→ [노드에 공유 상태 표시 (공유 아이콘)]
```

### 7. 아카이브 플로우

```
[아카이브 페이지 (/archive)]
    │
    ├─→ [로그인 확인]
    │       │
    │       └─→ [로그인 안됨] → [로그인 페이지로 리다이렉트]
    │
    └─→ [로그인 됨] → [모든 프로젝트의 에피소드 노드 조회]
            │
            ├─→ [에피소드 목록 테이블 형식으로 표시]
            │       │
            │       ├─→ [계층 구조 표시 (프로젝트 > 대분류 > 경험 > 에피소드)]
            │       ├─→ [STAR 내용, 태그, 회사명 등 정보 표시]
            │       │
            │       ├─→ [검색 기능]
            │       │       │
            │       │       └─→ [검색어 입력] → [에피소드 라벨, STAR 내용, 태그에서 검색] → [실시간 필터링]
            │       │
            │       ├─→ [필터링 기능]
            │       │       │
            │       │       ├─→ [대분류(배지)별 필터링]
            │       │       ├─→ [역량 태그별 필터링]
            │       │       └─→ [회사명별 필터링]
            │       │
            │       ├─→ [에피소드 편집]
            │       │       │
            │       │       └─→ [STAR 내용 셀 클릭] → [인라인 편집 모드] → [수정] → [저장]
            │       │
            │       └─→ [에피소드 삭제]
            │               │
            │               └─→ [삭제 버튼 클릭] → [삭제 확인 다이얼로그] → [확인] → [에피소드 및 STAR 에셋 삭제]
```

### 8. 대시보드 플로우

```
[대시보드 페이지 (/dashboard)]
    │
    ├─→ [로그인 확인]
    │       │
    │       └─→ [로그인 안됨] → [로그인 페이지로 리다이렉트]
    │
    └─→ [로그인 됨] → [모든 프로젝트의 STAR 자기소개서 목록 조회]
            │
            ├─→ [STAR 목록 카드 형식으로 표시]
            │       │
            │       ├─→ [제목, 회사명, 역량 태그, 작성일 표시]
            │       │
            │       ├─→ [검색 기능]
            │       │       │
            │       │       └─→ [검색어 입력] → [제목, 내용, 회사명, 역량 태그에서 검색] → [실시간 필터링]
            │       │
            │       ├─→ [STAR 카드 클릭] → [상세 다이얼로그 표시]
            │       │       │
            │       │       ├─→ [Situation, Task, Action, Result 전체 내용 표시]
            │       │       ├─→ [제목, 회사명, 역량 태그 등 메타데이터 표시]
            │       │       ├─→ [작성일 표시]
            │       │       └─→ [복사 버튼] → [클립보드 복사]
            │       │
            │       └─→ [STAR 삭제]
            │               │
            │               └─→ [삭제 버튼 클릭] → [삭제 확인 다이얼로그] → [확인] → [STAR 에셋 삭제]
```

### 9. 로그아웃 플로우

```
[어떤 페이지에서든]
    │
    └─→ [로그아웃 버튼 클릭]
            │
            └─→ [Supabase Auth 세션 종료]
                    │
                    ├─→ [localStorage의 사용자 정보 삭제]
                    └─→ [로그인 페이지로 리다이렉트]
```

---

## 주요 분기점 및 조건

### 인증 관련 분기
- **로그인 상태**: 모든 보호된 라우트에서 로그인 상태 확인
- **returnUrl**: 로그인 후 원래 가려던 페이지로 리다이렉트
- **프로젝트 존재 여부**: 프로젝트 목록에서 프로젝트가 없으면 배지 선택 페이지로 유도

### 공유 링크 관련 분기
- **로그인 상태**: 공유 링크 접근 시 로그인 여부에 따라 읽기 전용/편집 모드 구분
- **공유 노드 존재 여부**: 유효하지 않은 nodeId는 404 에러

### 노드 조작 관련 분기
- **노드 타입/레벨**: 노드 레벨에 따라 자동으로 노드 타입 설정 (대분류, 경험, 에피소드, 상세)
- **편집 모드**: 더블클릭 또는 우클릭 메뉴로 편집 모드 진입

### 사이드바 관련 분기
- **메인 탭**: 공백 진단하기, 어시스턴트, STAR 정리하기
- **공백 진단 서브 탭**: 부족 역량확인, 추천 인벤토리
- **STAR 진행 단계**: Situation → Task → Action → Result 순서

---

## 에러 처리 플로우

### 인증 에러
- OAuth 인증 실패 → 에러 메시지 표시 → 로그인 페이지 유지
- 세션 만료 → 자동 로그아웃 → 로그인 페이지로 리다이렉트

### 데이터 로딩 에러
- 프로젝트 로드 실패 → 에러 메시지 → 프로젝트 목록으로 리다이렉트
- 노드 로드 실패 → 에러 메시지 → 빈 상태 표시

### 공유 링크 에러
- 유효하지 않은 nodeId → 404 페이지
- 공유 노드 없음 → 에러 메시지 → 404 페이지

---

## 특수 케이스

### 1. OAuth 콜백 처리
- 랜딩 페이지에서 OAuth 코드가 URL 파라미터로 전달되면 자동으로 콜백 페이지로 리다이렉트

### 2. 온보딩 튜토리얼
- 마인드맵 편집 페이지 최초 진입 시에만 표시
- localStorage에 표시 여부 저장하여 재진입 시 표시하지 않음

### 3. 공유 링크에서 편집
- 로그인한 사용자가 공유 링크에 접근하면 편집 가능
- 변경 사항은 원본 프로젝트에 반영 (개별 노드 CRUD 사용)

### 4. 태그 드롭 노드 생성
- 공백 진단의 역량 태그를 마인드맵 노드로 드롭하면 노드 추가 다이얼로그 표시
- 노드 생성 후 AI 어시스턴트 자동 열기

---

## 플로우차트 작성 시 주의사항

1. **모든 진입점 표시**: 랜딩 페이지와 공유 링크 두 가지 진입점을 명확히 구분
2. **조건 분기 명확화**: 로그인 상태, 프로젝트 존재 여부 등 모든 조건 분기 표시
3. **에러 처리 포함**: 각 단계에서 발생할 수 있는 에러와 처리 방법 표시
4. **순환 참조 방지**: 무한 루프가 발생하지 않도록 주의
5. **병렬 처리 표시**: 여러 기능이 동시에 사용 가능한 경우 (예: 사이드바 기능들)
6. **상태 저장 지점**: localStorage, Supabase DB 저장 시점 명확히 표시
7. **사용자 액션과 시스템 응답 구분**: 사용자 액션은 사각형, 시스템 처리/판단은 다이아몬드로 구분

---

## 플로우차트 기호 권장사항

- **시작/종료**: 타원형
- **프로세스**: 사각형
- **판단/조건**: 다이아몬드
- **데이터 저장**: 원통형
- **페이지/화면**: 둥근 사각형
- **화살표**: 방향과 조건 명시

---

이 프롬프트를 Figma Make에 입력하면 Episode 서비스의 전체 프로세스 플로우차트를 생성할 수 있습니다.
